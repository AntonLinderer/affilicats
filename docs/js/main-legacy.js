"use strict";function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(){var b,c,a=Math.floor,d=2,e=document.querySelector(".offline"),f=document.querySelector("main"),g=document.querySelector("input[type=\"search\"]"),h=document.querySelector("button[type=\"submit\"]"),j=document.getElementById("cat"),k=document.querySelector(".install"),l=new IntersectionObserver(function(a){a.forEach(function(a){if(0<a.intersectionRatio){var b=a.target;// Lazy-load image
if(l.unobserve(b),"IMG"===b.nodeName)// Cache-bust so the browser doesn't use a cached fallback image
return b.src="".concat(b.dataset.src).concat(/\?/.test(b.dataset.src)?"&":"?").concat(Math.random().toString().substr(2));var c=b.classList;// Lazy-load photos
if(c.contains("photos"))return q(b);// Lazy-load reviews
if(c.contains("reviews"))return p(b);// Lazy-load offers
if(c.contains("offers"))return o(b)}})}),m=/*#__PURE__*/function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(b){var c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c="https://commons.wikimedia.org/w/api.php?action=query&generator=categorymembers&gcmlimit=max&gcmtype=file"+"&gcmtitle=Category:".concat(encodeURIComponent(b.replace(/\s/g," ")))+"&prop=imageinfo&iiurlwidth=500&iiprop=extmetadata|url&iiextmetadatafilter=ImageDescription&format=json&origin=*",a.abrupt("return",fetch(c).then(function(a){if(!a.ok)throw new TypeError("Could not load ".concat(c));return a.json()}).then(function(a){return a&&a.query&&a.query.pages?Object.keys(a.query.pages).map(function(b){var c=a.query.pages[b];try{c=c.imageinfo[0];var d=c.thumburl,e=c.descriptionshorturl,f=c.thumbwidth,g=c.thumbheight,h=c.extmetadata.ImageDescription.value;return{url:e,src:d,description:h,width:f,height:g}}catch(a){return}}).filter(function(a){return"undefined"!=typeof a}):void 0}).catch(function(a){return console.error(a)}));case 2:case"end":return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}(),n=function(b,e,f){var h=c&&"pushManager"in c,i=document.createDocumentFragment();b.forEach(function(b,c){var f=Math.round,j=document.importNode(e.content,!0),k=j.querySelector("figure img");k.alt="Illustrative ".concat(g.value.toLowerCase()," image"),k.classList.add("lazyload"),k.dataset.src=b.src;// Description
var l=j.querySelector("figcaption");l.textContent=(l.innerHTML=b.description,l.textContent);// Metadata
var m=j.querySelector(".pricedrop");h?(m.addEventListener("click",function(){m.innerHTML=m.innerHTML.replace("\uD83D\uDECE","\u23F3"),_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(){var b;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,u();case 2:b=a.sent,b?(m.disabled=!0,m.dataset.active="false",m.innerHTML=m.innerHTML.replace("\u23F3","\u2705")):m.innerHTML=m.innerHTML.replace("\u23F3","\uD83D\uDECE");case 4:case"end":return a.stop();}},a,this)}))()}),m.hidden=!1):m.hidden=!0;var n=j.querySelector(".cuteness");n.textContent="".concat("\uD83D\uDE3B".repeat(a(5*Math.random())+1));var o=j.querySelector(".price");o.textContent="".concat("\uD83D\uDCB0".repeat(a(3*Math.random())+1));// Outlink
var p=j.querySelector(".outlink"),q="./forward.html?url=".concat(encodeURIComponent(b.url));p.dataset.href=q,j.querySelector(".offers").dataset.outclickURL=q,p.textContent="\uD83D\uDCE6 View Deal",p.addEventListener("click",function(){var a=localStorage.getItem("engagement");a?(a=parseInt(a,10),!isNaN(a)&&a<d&&localStorage.setItem("engagement",++a)):localStorage.setItem("engagement",1),document.location.href=p.dataset.href});// Tabs
var s=j.querySelector(".tabs");s.addEventListener("click",function(){r(s)});var t=s.querySelectorAll(".tab label"),v=s.querySelectorAll(".tabcontent");s.querySelectorAll(".tab input").forEach(function(a,b){var d=Math.random().toString().substr(2);a.name="tabgroup".concat(c),a.id=d,t[b].setAttribute("for",d),v[b].setAttribute("aria-labelledby",d)});// Map
var w=s.querySelector(".map"),x=f(1e5*(90*((.5>Math.random()?-1:1)*Math.random())))/1e5,y=f(1e5*(180*((.5>Math.random()?-1:1)*Math.random())))/1e5;w.dataset.src="https://maps.googleapis.com/maps/api/staticmap?autoscale=1&size=500x350&maptype=terrain&key=AIzaSyBWZnCRi6oar3MTjR0HkR1lK52_mTe0Rks&format=png"+"&markers=size:small%7Ccolor:0xfffb00%7C".concat(x,",").concat(y),w.alt="Map centered on latitude ".concat(x," and longitude ").concat(y),s.querySelector(".lat").textContent=x,s.querySelector(".long").textContent=y,i.appendChild(j)}),f.innerHTML="",f.appendChild(i)},o=function(b){var c=b.dataset.outclickURL,d=document.createDocumentFragment(),e="https://www.random.org/integers/"+"?num=".concat(a(4*Math.random())+2)+"&min=5&max=20&col=1&base=10&format=plain&rnd=new";fetch(e).then(function(a){if(!a.ok)throw new TypeError("Could not load ".concat(e));return a.text()}).then(function(a){var e=a.split(/\n/g);e.splice(-1,1),e.map(function(a){return isNaN(parseInt(a,10))?a:parseInt(a+"9",10)}).sort(function(c,a){return c-a}).map(function(a,b){var e=document.createElement("li");e.innerHTML=/\d+/.test(a)?"<sup>$</sup>"+"<span class=\"price\">".concat(a,"</span> |")+"<a href=\"".concat(c,"\">Affiliate ").concat(b,"</a>"):a,d.appendChild(e)}),b.innerHTML="",b.appendChild(d)}).catch(function(a){return console.error(a)})},p=function(b){for(var c=document.createDocumentFragment(),d=[],e=function(b){var c="https://baconipsum.com/api/?type=all-meat&paras=".concat(a(3*Math.random())+1,"&start-with-lorem=1&random=").concat(b);d[b]=fetch(c).then(function(a){if(!a.ok)throw new TypeError("Could not load ".concat(c));return a.json()}).then(function(a){return"<li>".concat(a.map(function(a){return"<p>".concat(a,"</p>")}).join(""),"</li>")}).catch(function(a){return console.error(a)})},f=0,g=a(6*Math.random())+2;f<g;f++)e(f,g);Promise.all(d).then(function(a){return a.join("")}).then(function(a){var d=document.createElement("ul");d.innerHTML=a,c.appendChild(d),b.innerHTML="",b.appendChild(c)})},q=function(b){var c=document.createDocumentFragment(),d=document.createElement("div");d.classList.add("gallery"),c.appendChild(d);for(var e=[],f=function(b){var c=10*(a(10*Math.random())+20),d=10*(a(5*Math.random())+20),f="https://placekitten.com/".concat(c,"/").concat(d,"?random=").concat(b);e[b]=fetch(f).then(function(a){if(!a.ok)throw new TypeError("Could not load ".concat(f));return a.blob()}).then(function(a){return{width:c,height:d,blob:a}})},h=0,j=a(15*Math.random())+2;h<j;h++)f(h,j);Promise.all(e).then(function(a){a.forEach(function(a){var b=new Image(a.width,a.height);b.alt="Illustrative ".concat(g.value.toLowerCase()," image"),b.src=URL.createObjectURL(a.blob),d.appendChild(b)}),b.innerHTML="",b.appendChild(c)}).catch(function(a){return console.error(a)})},r=function(){var a=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0],b=a?a.querySelectorAll(".lazyload"):document.querySelectorAll(".lazyload");b.forEach(function(a){l.observe(a)})};window.addEventListener("offline",function(){e.style.display="flex",g.disabled=!0,h.disabled=!0,document.querySelectorAll("[data-active=\"true\"]").forEach(function(a){a.disabled=!0})}),window.addEventListener("online",function(){e.style.display="none",g.disabled=!1,h.disabled=!1,document.querySelectorAll("[data-active=\"true\"]").forEach(function(a){a.disabled=!1}),"false"===f.dataset.hydrated&&w(),r()});var s=function(){f.innerHTML="";for(var a=function(a){var b=j.content,c=b.querySelectorAll(".tab label"),d=b.querySelectorAll(".tabcontent");b.querySelectorAll(".tab input").forEach(function(b,e){var f=Math.random().toString().substr(2);b.name="tabgroup".concat(a),b.id=f,c[e].setAttribute("for",f),d[e].setAttribute("aria-labelledby",f)}),f.appendChild(document.importNode(b,!0))},b=0;3>b;b++)a(b)},t=function(){document.querySelector("form").addEventListener("submit",function(a){a.preventDefault(),s(),w()}),window.addEventListener("beforeinstallprompt",function(a){var c=localStorage.getItem("engagement");return c?(c=parseInt(c,10),isNaN(c)||c<d?void console.log("Install button hidden due to not enough prior engagement"):void(a.preventDefault(),b=a,k.disabled=!1,k.hidden=!1)):void console.log("Install button hidden due to no prior engagement")}),k.addEventListener("click",function(){k.disabled=!0,k.hidden=!0,b.prompt(),b.userChoice.then(function(a){"accepted"===a.outcome?console.log("User accepted the A2HS prompt"):console.log("User dismissed the A2HS prompt"),b=null})}),s();var a=navigator.onLine;e.style.display=a?"none":"flex",g.disabled=!a,h.disabled=!a,a&&w(),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then(function(a){c=a,c.onupdatefound=v,v()}).catch(function(a){return console.error(a)})},u=/*#__PURE__*/function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(){var b;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(c&&"pushManager"in c){a.next=2;break}return a.abrupt("return",!1);case 2:return b=function(a){for(var b="=".repeat((4-a.length%4)%4),c=(a+b).replace(/\-/g,"+").replace(/_/g,"/"),d=window.atob(c),e=new Uint8Array(d.length),f=0;f<d.length;++f)e[f]=d.charCodeAt(f);return e},a.abrupt("return",c.pushManager.getSubscription().then(function(a){if(a)return a;var d=b("BHuCD9Ym4yXI9Fk0KHrRcPgH2iQOXhoWbzWtm4GQocD1zGYz4IXyazINE_-T4pEojrAgqoGoRnxUgX5CAuguRGo");return c.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:d})}).then(function(a){return fetch("https://affilicats-push.glitch.me/push/sendNotification",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({subscription:a,delay:5,ttl:0})}),fetch("https://affilicats-push.glitch.me/push/register",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify({subscription:a})}).then(function(a){return a.ok})}).catch(function(a){return console.error(a),!1}));case 4:case"end":return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}(),v=/*#__PURE__*/function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(){var b,c,d,e,f;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b=/*#__PURE__*/function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(b){var c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=new Request(b,{mode:"no-cors"}),a.abrupt("return",fetch(c).then(function(a){return d.put(c,a)}).catch(function(a){return console.error(a)}));case 2:case"end":return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}(),a.next=3,caches.keys();case 3:return c=a.sent,a.next=6,caches.open(c.filter(function(a){return /^offline_/.test(a)})[0]);case 6:d=a.sent,e=0;case 8:if(!(e<localStorage.length)){a.next=24;break}if(f=localStorage.key(e),"polyfill"!==localStorage.getItem(f)){a.next=20;break}a.t0=f,a.next="IntersectionObserver"===a.t0?14:"PWACompat"===a.t0?16:"URLSearchParams"===a.t0?18:20;break;case 14:return b("https://unpkg.com/intersection-observer@0.5.0/intersection-observer.js"),a.abrupt("break",20);case 16:return b("https://unpkg.com/pwacompat@2.0.7/pwacompat.min.js"),a.abrupt("break",20);case 18:return b("https://unpkg.com/url-search-params@1.1.0/build/url-search-params.js"),a.abrupt("break",20);case 20:;case 21:e++,a.next=8;break;case 24:case"end":return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}(),w=/*#__PURE__*/function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(){var b,c,d,e;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b=new URLSearchParams(document.location.search),c=b.get("query"),c&&!g.value&&(g.value=c),c||g.value||(g.value="Felis silvestris catus"),d=g.value||"Felis silvestris catus",a.next=7,m(d);case 7:e=a.sent,Array.isArray(e)&&0<e.length?(f.dataset.hydrated="true","Felis silvestris catus"!==d&&history.pushState({},"","".concat(document.location.origin).concat(document.location.pathname,"?query=").concat(encodeURIComponent(d))),n(e,j,f)):f.innerHTML="<p>\uD83D\uDE25 No results found.</p><p>Try anything that is a<a href=\"https://commons.wikimedia.org/wiki/Category:Topics\">Wikimedia Categorie</a>. Maybe try<a href=\"./?query=Elephants\">Elephants</a> \uD83D\uDC18</p>",r();case 10:case"end":return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}();t()})();
